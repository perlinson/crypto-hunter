<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Hunter Pro - È´òÁ∫ßÂä†ÂØÜË¥ßÂ∏Å‰∫§ÊòìÂπ≥Âè∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .glass { background: rgba(30, 41, 59, 0.8); backdrop-filter: blur(12px); }
        .tab-active { border-bottom: 2px solid #8b5cf6; color: #8b5cf6; }
        .glow-purple { box-shadow: 0 0 30px rgba(139, 92, 246, 0.3); }
        .glow-green { box-shadow: 0 0 30px rgba(34, 197, 94, 0.3); }
        .glow-red { box-shadow: 0 0 30px rgba(239, 68, 68, 0.3); }
        .glow-yellow { box-shadow: 0 0 30px rgba(234, 179, 8, 0.3); }
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(139, 92, 246, 0.3); }
            50% { box-shadow: 0 0 40px rgba(139, 92, 246, 0.6); }
        }
        .animate-glow { animation: pulse-glow 2s ease-in-out infinite; }
        .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-950 to-slate-900 min-h-screen">
    <!-- È°∂ÈÉ®ÂØºËà™ -->
    <nav class="glass border-b border-white/10 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <span class="text-3xl">üêÇ</span>
                <div>
                    <h1 class="text-xl font-bold bg-gradient-to-r from-yellow-400 via-orange-500 to-purple-500 bg-clip-text text-transparent">
                        Crypto Hunter Pro
                    </h1>
                    <p class="text-xs text-gray-400">È´òÁ∫ßÂä†ÂØÜË¥ßÂ∏Å‰∫§ÊòìÂπ≥Âè∞</p>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <span class="text-sm text-gray-400" id="last-update">--</span>
                <div class="flex items-center gap-2">
                    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                    <span class="text-xs text-green-400">API Âú®Á∫ø</span>
                </div>
                <button onclick="openTab('dashboard')" class="px-3 py-1.5 text-sm bg-purple-600 hover:bg-purple-500 rounded-lg transition">
                    ‰ª™Ë°®Êùø
                </button>
            </div>
        </div>
    </nav>

    <!-- Tab ÂØºËà™ -->
    <div class="max-w-7xl mx-auto px-4 py-4">
        <div class="flex gap-4 border-b border-white/10 pb-2 overflow-x-auto">
            <button onclick="openTab('dashboard')" id="tab-dashboard" class="tab-active px-4 py-2 text-sm font-medium whitespace-nowrap">
                üìä ‰ª™Ë°®Êùø
            </button>
            <button onclick="openTab('portfolio')" id="tab-portfolio" class="px-4 py-2 text-sm font-medium text-gray-400 hover:text-white whitespace-nowrap">
                üíº ÊäïËµÑÁªÑÂêà
            </button>
            <button onclick="openTab('trading')" id="tab-trading" class="px-4 py-2 text-sm font-medium text-gray-400 hover:text-white whitespace-nowrap">
                üìà Ê®°Êãü‰∫§Êòì
            </button>
            <button onclick="openTab('alerts')" id="tab-alerts" class="px-4 py-2 text-sm font-medium text-gray-400 hover:text-white whitespace-nowrap">
                üîî Êô∫ËÉΩÊèêÈÜí
            </button>
            <button onclick="openTab('analysis')" id="tab-analysis" class="px-4 py-2 text-sm font-medium text-gray-400 hover:text-white whitespace-nowrap">
                üìâ Ë∂ãÂäøÂàÜÊûê
            </button>
        </div>
    </div>

    <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
    <div class="max-w-7xl mx-auto px-4 pb-8">
        
        <!-- ==================== ‰ª™Ë°®Êùø Tab ==================== -->
        <div id="content-dashboard" class="tab-content">
            <!-- ÁªüËÆ°Âç°Áâá -->
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
                <div class="glass rounded-xl p-4 border border-white/10">
                    <p class="text-gray-400 text-xs">BTC ‰ª∑Ê†º</p>
                    <p class="text-xl font-bold text-yellow-400" id="btc-price">--</p>
                    <p class="text-xs" id="btc-change">--</p>
                </div>
                <div class="glass rounded-xl p-4 border border-white/10">
                    <p class="text-gray-400 text-xs">ETH ‰ª∑Ê†º</p>
                    <p class="text-xl font-bold text-purple-400" id="eth-price">--</p>
                    <p class="text-xs" id="eth-change">--</p>
                </div>
                <div class="glass rounded-xl p-4 border border-white/10">
                    <p class="text-gray-400 text-xs">ÊÄªÊåÅ‰ªì‰ª∑ÂÄº</p>
                    <p class="text-xl font-bold text-green-400" id="portfolio-value">--</p>
                    <p class="text-xs" id="portfolio-profit">--</p>
                </div>
                <div class="glass rounded-xl p-4 border border-white/10">
                    <p class="text-gray-400 text-xs">Ê®°ÊãüËµÑÈáë</p>
                    <p class="text-xl font-bold text-blue-400" id="paper-balance">$10,000</p>
                    <p class="text-xs text-gray-400">Ê®°Êãü‰∫§Êòì</p>
                </div>
                <div class="glass rounded-xl p-4 border border-white/10">
                    <p class="text-gray-400 text-xs">Ê¥ªË∑ÉÈ¢ÑË≠¶</p>
                    <p class="text-xl font-bold text-orange-400" id="active-alerts">0</p>
                    <p class="text-xs text-gray-400">ÂæÖËß¶Âèë</p>
                </div>
            </div>

            <!-- ‰ª∑Ê†ºËµ∞ÂäøÂõæË°® -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                <div class="lg:col-span-2 glass rounded-xl p-6 border border-white/10">
                    <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">
                        üìà BTC/ETH ‰ª∑Ê†ºËµ∞Âäø
                    </h2>
                    <canvas id="priceChart" height="300"></canvas>
                </div>
                <div class="glass rounded-xl p-6 border border-white/10">
                    <h2 class="text-lg font-semibold mb-4">üìä Â∏ÇÂÄºÂç†ÊØî</h2>
                    <canvas id="marketChart" height="300"></canvas>
                </div>
            </div>

            <!-- Ê∂®Ë∑åÂπÖÊéíË°å -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="glass rounded-xl p-6 border border-white/10">
                    <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">
                        üöÄ Ê∂®ÂπÖÊ¶ú Top 10
                    </h2>
                    <div class="overflow-x-auto scrollbar-thin">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="text-left text-gray-400 border-b border-white/10">
                                    <th class="pb-2">#</th>
                                    <th class="pb-2">Â∏ÅÁßç</th>
                                    <th class="pb-2">‰ª∑Ê†º</th>
                                    <th class="pb-2">24h</th>
                                </tr>
                            </thead>
                            <tbody id="gainers-table" class="divide-y divide-white/5">
                                <tr><td colspan="4" class="py-4 text-center text-gray-400">Âä†ËΩΩ‰∏≠...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="glass rounded-xl p-6 border border-white/10">
                    <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">
                        üìâ Ë∑åÂπÖÊ¶ú Top 10
                    </h2>
                    <div class="overflow-x-auto scrollbar-thin">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="text-left text-gray-400 border-b border-white/10">
                                    <th class="pb-2">#</th>
                                    <th class="pb-2">Â∏ÅÁßç</th>
                                    <th class="pb-2">‰ª∑Ê†º</th>
                                    <th class="pb-2">24h</th>
                                </tr>
                            </thead>
                            <tbody id="losers-table" class="divide-y divide-white/5">
                                <tr><td colspan="4" class="py-4 text-center text-gray-400">Âä†ËΩΩ‰∏≠...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== ÊäïËµÑÁªÑÂêà Tab ==================== -->
        <div id="content-portfolio" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- ÊåÅ‰ªìÊ¶ÇËßà -->
                <div class="lg:col-span-2 glass rounded-xl p-6 border border-white/10">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold">üíº ÊàëÁöÑÊåÅ‰ªì</h2>
                        <button onclick="openModal('addHolding')" class="px-3 py-1.5 bg-green-600 hover:bg-green-500 text-sm rounded-lg transition">
                            + Ê∑ªÂä†ÊåÅ‰ªì
                        </button>
                    </div>
                    
                    <!-- Ê±áÊÄªÂç°Áâá -->
                    <div class="grid grid-cols-3 gap-4 mb-6">
                        <div class="bg-white/5 rounded-lg p-4 text-center">
                            <p class="text-gray-400 text-xs">ÊÄª‰ª∑ÂÄº</p>
                            <p class="text-xl font-bold text-green-400" id="pf-total-value">$0</p>
                        </div>
                        <div class="bg-white/5 rounded-lg p-4 text-center">
                            <p class="text-gray-400 text-xs">ÊÄªÊàêÊú¨</p>
                            <p class="text-xl font-bold text-blue-400" id="pf-total-cost">$0</p>
                        </div>
                        <div class="bg-white/5 rounded-lg p-4 text-center">
                            <p class="text-gray-400 text-xs">Êî∂ÁõäÁéá</p>
                            <p class="text-xl font-bold" id="pf-total-profit">+0.00%</p>
                        </div>
                    </div>
                    
                    <!-- ÊåÅ‰ªìÂàóË°® -->
                    <div class="overflow-x-auto scrollbar-thin">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="text-left text-gray-400 border-b border-white/10">
                                    <th class="pb-2">Â∏ÅÁßç</th>
                                    <th class="pb-2">Êï∞Èáè</th>
                                    <th class="pb-2">Âùá‰ª∑</th>
                                    <th class="pb-2">ÂΩìÂâç‰ª∑</th>
                                    <th class="pb-2">‰ª∑ÂÄº</th>
                                    <th class="pb-2">Áõà‰∫è</th>
                                    <th class="pb-2">Êìç‰Ωú</th>
                                </tr>
                            </thead>
                            <tbody id="holdings-table" class="divide-y divide-white/5">
                                <tr><td colspan="7" class="py-8 text-center text-gray-400">ÊöÇÊó†ÊåÅ‰ªì</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- ‰∫§ÊòìÂéÜÂè≤ -->
                <div class="glass rounded-xl p-6 border border-white/10">
                    <h2 class="text-lg font-semibold mb-4">üìú ‰∫§ÊòìÂéÜÂè≤</h2>
                    <div class="space-y-3 max-h-96 overflow-y-auto scrollbar-thin" id="pf-history">
                        <p class="text-gray-400 text-center py-4">ÊöÇÊó†‰∫§ÊòìËÆ∞ÂΩï</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== Ê®°Êãü‰∫§Êòì Tab ==================== -->
        <div id="content-trading" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- ‰∫§ÊòìÈù¢Êùø -->
                <div class="lg:col-span-2 glass rounded-xl p-6 border border-white/10">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold">üìà Ê®°Êãü‰∫§Êòì</h2>
                        <button onclick="resetPaperTrading()" class="px-3 py-1.5 bg-red-600 hover:bg-red-500 text-sm rounded-lg transition">
                            üîÑ ÈáçÁΩÆË¥¶Êà∑
                        </button>
                    </div>
                    
                    <!-- ÁªüËÆ°Âç°Áâá -->
                    <div class="grid grid-cols-4 gap-4 mb-6">
                        <div class="bg-white/5 rounded-lg p-4 text-center">
                            <p class="text-gray-400 text-xs">Ë¥¶Êà∑‰ΩôÈ¢ù</p>
                            <p class="text-xl font-bold text-green-400" id="pt-balance">$10,000</p>
                        </div>
                        <div class="bg-white/5 rounded-lg p-4 text-center">
                            <p class="text-gray-400 text-xs">ÊÄªÊî∂Áõä</p>
                            <p class="text-xl font-bold" id="pt-profit">$0</p>
                        </div>
                        <div class="bg-white/5 rounded-lg p-4 text-center">
                            <p class="text-gray-400 text-xs">‰∫§ÊòìÊ¨°Êï∞</p>
                            <p class="text-xl font-bold text-purple-400" id="pt-trades">0</p>
                        </div>
                        <div class="bg-white/5 rounded-lg p-4 text-center">
                            <p class="text-gray-400 text-xs">ËÉúÁéá</p>
                            <p class="text-xl font-bold text-yellow-400" id="pt-winrate">0%</p>
                        </div>
                    </div>
                    
                    <!-- ‰∫§ÊòìË°®Âçï -->
                    <div class="bg-white/5 rounded-lg p-6 mb-6">
                        <div class="grid grid-cols-4 gap-4 mb-4">
                            <div>
                                <label class="block text-xs text-gray-400 mb-1">‰∫§ÊòìÂØπ</label>
                                <select id="trade-symbol" class="w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm">
                                    <option value="BTC">BTC/USDT</option>
                                    <option value="ETH">ETH/USDT</option>
                                    <option value="SOL">SOL/USDT</option>
                                    <option value="BNB">BNB/USDT</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-xs text-gray-400 mb-1">‰ª∑Ê†º</label>
                                <input type="number" id="trade-price" class="w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm" placeholder="Â∏Ç‰ª∑">
                            </div>
                            <div>
                                <label class="block text-xs text-gray-400 mb-1">Êï∞Èáè</label>
                                <input type="number" id="trade-amount" class="w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm" placeholder="0.00">
                            </div>
                            <div>
                                <label class="block text-xs text-gray-400 mb-1">Á±ªÂûã</label>
                                <select id="trade-type" class="w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm">
                                    <option value="market">Â∏Ç‰ª∑</option>
                                    <option value="limit">Èôê‰ª∑</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex gap-4">
                            <button onclick="executeTrade('buy')" class="flex-1 bg-green-600 hover:bg-green-500 py-3 rounded-lg font-semibold transition">
                                üü¢ ‰π∞ÂÖ•
                            </button>
                            <button onclick="executeTrade('sell')" class="flex-1 bg-red-600 hover:bg-red-500 py-3 rounded-lg font-semibold transition">
                                üî¥ ÂçñÂá∫
                            </button>
                        </div>
                    </div>
                    
                    <!-- ÂΩìÂâçÊåÅ‰ªì -->
                    <h3 class="text-sm font-semibold mb-3">üì¶ ÂΩìÂâçÊåÅ‰ªì</h3>
                    <div class="space-y-2" id="pt-positions">
                        <p class="text-gray-400 text-center py-4">ÊöÇÊó†ÊåÅ‰ªì</p>
                    </div>
                </div>
                
                <!-- ‰∫§ÊòìÂéÜÂè≤ -->
                <div class="glass rounded-xl p-6 border border-white/10">
                    <h2 class="text-lg font-semibold mb-4">üìú Êàê‰∫§ËÆ∞ÂΩï</h2>
                    <div class="space-y-2 max-h-[500px] overflow-y-auto scrollbar-thin" id="pt-history">
                        <p class="text-gray-400 text-center py-4">ÊöÇÊó†Êàê‰∫§ËÆ∞ÂΩï</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== Êô∫ËÉΩÊèêÈÜí Tab ==================== -->
        <div id="content-alerts" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Ê∑ªÂä†ÊèêÈÜí -->
                <div class="glass rounded-xl p-6 border border-white/10">
                    <h2 class="text-lg font-semibold mb-4">üîî Ê∑ªÂä†ÊèêÈÜí</h2>
                    
                    <!-- ‰ª∑Ê†ºÊèêÈÜí -->
                    <div class="bg-white/5 rounded-lg p-4 mb-4">
                        <h3 class="text-sm font-semibold mb-3 flex items-center gap-2">
                            üí∞ ‰ª∑Ê†ºÊèêÈÜí
                        </h3>
                        <div class="grid grid-cols-4 gap-3">
                            <input type="text" id="alert-symbol" placeholder="Â∏ÅÁßç (BTC)" class="bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm">
                            <input type="number" id="alert-price" placeholder="ÁõÆÊ†á‰ª∑Ê†º" class="bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm">
                            <select id="alert-direction" class="bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm">
                                <option value="above">üöÄ Á™ÅÁ†¥</option>
                                <option value="below">üìâ Ë∑åÁ†¥</option>
                            </select>
                            <button onclick="addPriceAlert()" class="bg-purple-600 hover:bg-purple-500 rounded-lg text-sm transition">
                                Ê∑ªÂä†
                            </button>
                        </div>
                    </div>
                    
                    <!-- ÊîØÊíë/ÈòªÂäõ‰Ωç -->
                    <div class="bg-white/5 rounded-lg p-4 mb-4">
                        <h3 class="text-sm font-semibold mb-3 flex items-center gap-2">
                            üìä ÊîØÊíë/ÈòªÂäõ‰ΩçÊèêÈÜí
                        </h3>
                        <div class="grid grid-cols-4 gap-3">
                            <input type="text" id="sr-symbol" placeholder="Â∏ÅÁßç" class="bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm">
                            <input type="number" id="sr-level" placeholder="‰ª∑Ê†º‰Ωç" class="bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm">
                            <select id="sr-type" class="bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm">
                                <option value="both">ÊîØÊíë & ÈòªÂäõ</option>
                                <option value="support">‰ªÖÊîØÊíë</option>
                                <option value="resistance">‰ªÖÈòªÂäõ</option>
                            </select>
                            <button onclick="addSRError!");return false;" class="bg-yellow-600 hover:bg-yellow-500 rounded-lg text-sm transition">
                                Ê∑ªÂä†
                            </button>
                        </div>
                    </div>
                    
                    <!-- Ê∑ªÂä†Â§ö‰∏™ÊîØÊíë/ÈòªÂäõ‰Ωç -->
                    <div class="bg-white/5 rounded-lg p-4">
                        <h3 class="text-sm font-semibold mb-3">üìà ÊâπÈáèÊ∑ªÂä†ÊîØÊíë/ÈòªÂäõ‰Ωç</h3>
                        <div class="grid grid-cols-2 gap-3">
                            <input type="text" id="sr-multi-symbol" placeholder="Â∏ÅÁßç (Â¶Ç BTC)" class="bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm">
                            <input type="text" id="sr-multi-levels" placeholder="‰ª∑Ê†º‰Ωç (ÈÄóÂè∑ÂàÜÈöî, Â¶Ç 70000,75000,80000)" class="bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm">
                        </div>
                        <button onclick="addMultiSR()" class="mt-3 w-full bg-yellow-600 hover:bg-yellow-500 rounded-lg text-sm py-2 transition">
                            ÊâπÈáèÊ∑ªÂä†
                        </button>
                    </div>
                </div>
                
                <!-- ÊèêÈÜíÂàóË°® -->
                <div class="glass rounded-xl p-6 border border-white/10">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold">üìã ÊèêÈÜíÂàóË°®</h2>
                        <button onclick="resetAlerts()" class="text-xs text-gray-400 hover:text-white">
                            ÈáçÁΩÆÂ∑≤Ëß¶Âèë
                        </button>
                    </div>
                    
                    <!-- ‰ª∑Ê†ºÊèêÈÜí -->
                    <div class="mb-4">
                        <h3 class="text-xs text-gray-400 mb-2">‰ª∑Ê†ºÊèêÈÜí</h3>
                        <div class="flex flex-wrap gap-2" id="price-alerts-list">
                            <p class="text-gray-400 text-sm">ÊöÇÊó†ÊèêÈÜí</p>
                        </div>
                    </div>
                    
                    <!-- ÊîØÊíë/ÈòªÂäõ‰Ωç -->
                    <div>
                        <h3 class="text-xs text-gray-400 mb-2">ÊîØÊíë/ÈòªÂäõ‰Ωç</h3>
                        <div class="flex flex-wrap gap-2" id="sr-alerts-list">
                            <p class="text-gray-400 text-sm">ÊöÇÊó†ËÆæÁΩÆ</p>
                        </div>
                    </div>
                </div>
                
                <!-- Ëß¶ÂèëËÆ∞ÂΩï -->
                <div class="lg:col-span-2 glass rounded-xl p-6 border border-white/10">
                    <h2 class="text-lg font-semibold mb-4">üö® ÊúÄËøëËß¶Âèë</h2>
                    <div class="space-y-3" id="triggered-alerts">
                        <p class="text-gray-400 text-center py-4">ÊöÇÊó†Ëß¶ÂèëËÆ∞ÂΩï</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== Ë∂ãÂäøÂàÜÊûê Tab ==================== -->
        <div id="content-analysis" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- ‰∏ªÂõæË°® -->
                <div class="lg:col-span-2 glass rounded-xl p-6 border border-white/10">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold">üìà ‰ª∑Ê†ºË∂ãÂäøÂàÜÊûê</h2>
                        <div class="flex gap-2">
                            <select id="chart-symbol" class="bg-white/10 border border-white/20 rounded-lg px-3 py-1.5 text-sm">
                                <option value="BTC">BTC</option>
                                <option value="ETH">ETH</option>
                                <option value="SOL">SOL</option>
                            </select>
                            <select id="chart-period" class="bg-white/10 border border-white/20 rounded-lg px-3 py-1.5 text-sm">
                                <option value="24h">24Â∞èÊó∂</option>
                                <option value="7d">7Â§©</option>
                                <option value="30d">30Â§©</option>
                            </select>
                        </div>
                    </div>
                    <canvas id="trendChart" height="350"></canvas>
                    
                    <!-- ÊîØÊíë/ÈòªÂäõ‰ΩçÊòæÁ§∫ -->
                    <div class="mt-4 grid grid-cols-2 gap-4">
                        <div class="bg-green-500/10 border border-green-500/30 rounded-lg p-3">
                            <p class="text-xs text-green-400 mb-1">üü¢ ÊîØÊíë‰Ωç</p>
                            <p class="text-sm" id="support-levels">--</p>
                        </div>
                        <div class="bg-red-500/10 border border-red-500/30 rounded-lg p-3">
                            <p class="text-xs text-red-400 mb-1">üî¥ ÈòªÂäõ‰Ωç</p>
                            <p class="text-sm" id="resistance-levels">--</p>
                        </div>
                    </div>
                </div>
                
                <!-- ÊäÄÊúØÊåáÊ†á -->
                <div class="glass rounded-xl p-6 border border-white/10">
                    <h2 class="text-lg font-semibold mb-4">üìä ÊäÄÊúØÊåáÊ†á</h2>
                    
                    <!-- RSI -->
                    <div class="bg-white/5 rounded-lg p-4 mb-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">RSI (14)</span>
                            <span id="rsi-value" class="font-bold">--</span>
                        </div>
                        <div class="mt-2 h-2 bg-gray-700 rounded-full overflow-hidden">
                            <div id="rsi-bar" class="h-full bg-blue-500 transition-all" style="width: 50%"></div>
                        </div>
                        <p class="text-xs text-gray-400 mt-1" id="rsi-signal">--</p>
                    </div>
                    
                    <!-- MACD -->
                    <div class="bg-white/5 rounded-lg p-4 mb-3">
                        <p class="text-sm text-gray-400 mb-2">MACD</p>
                        <div class="grid grid-cols-3 gap-2 text-xs">
                            <div>
                                <p class="text-gray-500">MACD</p>
                                <p id="macd-value" class="font-semibold">--</p>
                            </div>
                            <div>
                                <p class="text-gray-500">Signal</p>
                                <p id="macd-signal" class="font-semibold">--</p>
                            </div>
                            <div>
                                <p class="text-gray-500">Histogram</p>
                                <p id="macd-hist" class="font-semibold">--</p>
                            </div>
                        </div>
                        <p class="text-xs mt-2" id="macd-trend">--</p>
                    </div>
                    
                    <!-- ÁßªÂä®Âπ≥ÂùáÁ∫ø -->
                    <div class="bg-white/5 rounded-lg p-4 mb-3">
                        <p class="text-sm text-gray-400 mb-2">ÁßªÂä®Âπ≥ÂùáÁ∫ø</p>
                        <div class="space-y-1 text-xs">
                            <div class="flex justify-between">
                                <span class="text-yellow-400">MA7</span>
                                <span id="ma7">--</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-blue-400">MA25</span>
                                <span id="ma25">--</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-purple-400">MA99</span>
                                <span id="ma99">--</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Â§öÁ©∫‰ø°Âè∑ -->
                    <div class="bg-white/5 rounded-lg p-4">
                        <p class="text-sm text-gray-400 mb-2">ÁªºÂêà‰ø°Âè∑</p>
                        <div class="text-center">
                            <span id="overall-signal" class="text-2xl">--</span>
                            <p id="signal-text" class="text-sm mt-1">--</p>
                        </div>
                    </div>
                </div>
                
                <!-- ‰∫§ÊòìÊâÄ‰ª∑Ê†ºÂØπÊØî -->
                <div class="lg:col-span-3 glass rounded-xl p-6 border border-white/10">
                    <h2 class="text-lg font-semibold mb-4">üè¶ Â§ö‰∫§ÊòìÊâÄ‰ª∑Ê†ºÂØπÊØî</h2>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="text-left text-gray-400 border-b border-white/10">
                                    <th class="pb-2">Â∏ÅÁßç</th>
                                    <th class="pb-2">Binance</th>
                                    <th class="pb-2">CoinGecko</th>
                                    <th class="pb-2">Âùá‰ª∑</th>
                                    <th class="pb-2">‰ª∑Â∑Æ</th>
                                    <th class="pb-2">24hÊ∂®Ë∑å</th>
                                </tr>
                            </thead>
                            <tbody id="exchange-comparison" class="divide-y divide-white/5">
                                <tr><td colspan="6" class="py-4 text-center text-gray-400">Âä†ËΩΩ‰∏≠...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ê∑ªÂä†ÊåÅ‰ªì Modal -->
    <div id="modal-addHolding" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden flex items-center justify-center">
        <div class="glass rounded-xl p-6 w-full max-w-md border border-white/20">
            <h2 class="text-lg font-semibold mb-4">‚ûï Ê∑ªÂä†ÊåÅ‰ªì</h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-400 mb-1">Â∏ÅÁßç</label>
                    <input type="text" id="holding-symbol" placeholder="BTC" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white">
                </div>
                <div>
                    <label class="block text-sm text-gray-400 mb-1">Êï∞Èáè</label>
                    <input type="number" id="holding-amount" placeholder="0.00" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white">
                </div>
                <div>
                    <label class="block text-sm text-gray-400 mb-1">Âπ≥ÂùáÊàêÊú¨‰ª∑</label>
                    <input type="number" id="holding-price" placeholder="$" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white">
                </div>
                <div>
                    <label class="block text-sm text-gray-400 mb-1">‰∫§ÊòìÊâÄ</label>
                    <select id="holding-exchange" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 text-white">
                        <option value="Binance">Binance</option>
                        <option value="CoinGecko">CoinGecko</option>
                        <option value="OKX">OKX</option>
                        <option value="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</option>
                    </select>
                </div>
            </div>
            <div class="flex gap-4 mt-6">
                <button onclick="closeModal('addHolding')" class="flex-1 py-2 bg-gray-600 rounded-lg hover:bg-gray-500 transition">ÂèñÊ∂à</button>
                <button onclick="addHolding()" class="flex-1 py-2 bg-green-600 rounded-lg hover:bg-green-500 transition">Á°ÆËÆ§Ê∑ªÂä†</button>
            </div>
        </div>
    </div>

    <script>
        // ============== ÂÖ®Â±ÄÁä∂ÊÄÅ ==============
        const API_BASE = '';
        let prices = {};
        let portfolio = null;
        let paperTrading = null;
        let alerts = null;
        let charts = {};
        let currentTab = 'dashboard';

        // ============== ÂàùÂßãÂåñ ==============
        document.addEventListener('DOMContentLoaded', () => {
            refreshAllData();
            
            // ÂÆöÊó∂Âà∑Êñ∞
            setInterval(refreshAllData, 60000);
            setInterval(checkAlerts, 30000);
        });

        // ============== Tab ÂàáÊç¢ ==============
        function openTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('[id^="tab-"]').forEach(el => {
                el.classList.remove('tab-active');
                el.classList.add('text-gray-400');
            });
            
            document.getElementById(`content-${tabName}`).classList.remove('hidden');
            document.getElementById(`tab-${tabName}`).classList.add('tab-active');
            document.getElementById(`tab-${tabName}`).classList.remove('text-gray-400');
            
            currentTab = tabName;
            
            // ÂàùÂßãÂåñÂõæË°®
            if (tabName === 'analysis') {
                setTimeout(() => initAnalysisChart(), 100);
            }
        }

        // ============== Êï∞ÊçÆÂà∑Êñ∞ ==============
        async function refreshAllData() {
            try {
                // Ëé∑Âèñ‰ª∑Ê†ºÊï∞ÊçÆ
                const pricesRes = await fetch(`${API_BASE}/api/prices/top`);
                const pricesData = await pricesRes.json();
                
                if (Array.isArray(pricesData)) {
                    pricesData.forEach(p => {
                        prices[p.symbol] = p;
                    });
                }
                
                renderDashboard();
                updateExchangeComparison();
                
                document.getElementById('last-update').textContent = `ÊúÄÂêéÊõ¥Êñ∞: ${new Date().toLocaleTimeString()}`;
                
                // Ëé∑ÂèñÊäïËµÑÁªÑÂêà
                try {
                    const pfRes = await fetch(`${API_BASE}/api/portfolio`);
                    portfolio = await pfRes.json();
                    renderPortfolio();
                } catch (e) {
                    console.warn('ÊäïËµÑÁªÑÂêàÂä†ËΩΩÂ§±Ë¥•:', e);
                }
                
                // Ëé∑ÂèñÊ®°Êãü‰∫§ÊòìÊï∞ÊçÆ
                try {
                    const ptRes = await fetch(`${API_BASE}/api/paper-trading`);
                    paperTrading = await ptRes.json();
                    renderPaperTrading();
                } catch (e) {
                    console.warn('Ê®°Êãü‰∫§ÊòìÂä†ËΩΩÂ§±Ë¥•:', e);
                }
                
                // Ëé∑ÂèñÊèêÈÜí
                try {
                    const alertRes = await fetch(`${API_BASE}/api/alerts`);
                    alerts = await alertRes.json();
                    renderAlerts();
                } catch (e) {
                    console.warn('ÊèêÈÜíÂä†ËΩΩÂ§±Ë¥•:', e);
                }
                
            } catch (error) {
                console.error('Âà∑Êñ∞Êï∞ÊçÆÂ§±Ë¥•:', error);
                useMockData();
            }
        }

        // ‰ΩøÁî®Ê®°ÊãüÊï∞ÊçÆ
        function useMockData() {
            const mockPrices = generateMockPrices();
            Object.assign(prices, mockPrices);
            renderDashboard();
            renderPortfolio();
            renderPaperTrading();
            updateExchangeComparison();
            renderAlerts();
        }

        function generateMockPrices() {
            return {
                'BTC': { symbol: 'BTC', price: 71130, change24h: 2.92, sources: ['Binance', 'CoinGecko'] },
                'ETH': { symbol: 'ETH', price: 2110, change24h: 2.88, sources: ['Binance', 'CoinGecko'] },
                'SOL': { symbol: 'SOL', price: 87.73, change24h: 13.63, sources: ['Binance', 'CoinGecko'] },
                'BNB': { symbol: 'BNB', price: 643.45, change24h: 13.93, sources: ['Binance', 'CoinGecko'] },
                'XRP': { symbol: 'XRP', price: 2.34, change24h: -3.45, sources: ['CoinGecko'] },
                'ADA': { symbol: 'ADA', price: 0.98, change24h: -5.67, sources: ['CoinGecko'] },
                'DOGE': { symbol: 'DOGE', price: 0.09721, change24h: 12.45, sources: ['Binance'] },
            };
        }

        // ============== ‰ª™Ë°®ÊùøÊ∏≤Êüì ==============
        function renderDashboard() {
            // Êõ¥Êñ∞BTC/ETH‰ª∑Ê†º
            const btc = prices['BTC'];
            const eth = prices['ETH'];
            
            if (btc) {
                document.getElementById('btc-price').textContent = formatPrice(btc.price);
                document.getElementById('btc-change').textContent = `${btc.change24h >= 0 ? '+' : ''}${btc.change24h.toFixed(2)}%`;
                document.getElementById('btc-change').className = `text-xs ${btc.change24h >= 0 ? 'text-green-400' : 'text-red-400'}`;
            }
            
            if (eth) {
                document.getElementById('eth-price').textContent = formatPrice(eth.price);
                document.getElementById('eth-change').textContent = `${eth.change24h >= 0 ? '+' : ''}${eth.change24h.toFixed(2)}%`;
                document.getElementById('eth-change').className = `text-xs ${eth.change24h >= 0 ? 'text-green-400' : 'text-red-400'}`;
            }
            
            // Êõ¥Êñ∞ÊåÅ‰ªì‰ª∑ÂÄº
            if (portfolio) {
                document.getElementById('portfolio-value').textContent = formatPrice(portfolio.totalValue || 0);
                const profit = portfolio.totalProfitPercent || 0;
                document.getElementById('portfolio-profit').textContent = `${profit >= 0 ? '+' : ''}${profit.toFixed(2)}%`;
                document.getElementById('portfolio-profit').className = `text-xs ${profit >= 0 ? 'text-green-400' : 'text-red-400'}`;
            }
            
            // Êõ¥Êñ∞Ê®°ÊãüËµÑÈáë
            if (paperTrading) {
                document.getElementById('paper-balance').textContent = formatPrice(paperTrading.balance || 10000);
            }
            
            // Êõ¥Êñ∞Ê∂®ÂπÖÊ¶ú/Ë∑åÂπÖÊ¶ú
            const sortedCoins = Object.values(prices).sort((a, b) => b.change24h - a.change24h);
            const gainers = sortedCoins.slice(0, 10);
            const losers = sortedCoins.slice().reverse().slice(0, 10);
            
            renderGainers(gainers);
            renderLosers(losers);
            
            // Êõ¥Êñ∞ÂõæË°®
            initDashboardCharts();
        }

        function renderGainers(coins) {
            const tbody = document.getElementById('gainers-table');
            tbody.innerHTML = coins.map((coin, i) => `
                <tr class="border-b border-white/5 hover:bg-white/5">
                    <td class="py-2">${i + 1}</td>
                    <td class="py-2 font-medium">${coin.symbol}</td>
                    <td class="py-2">${formatPrice(coin.price)}</td>
                    <td class="py-2 text-green-400">+${coin.change24h.toFixed(2)}%</td>
                </tr>
            `).join('');
        }

        function renderLosers(coins) {
            const tbody = document.getElementById('losers-table');
            tbody.innerHTML = coins.map((coin, i) => `
                <tr class="border-b border-white/5 hover:bg-white/5">
                    <td class="py-2">${i + 1}</td>
                    <td class="py-2 font-medium">${coin.symbol}</td>
                    <td class="py-2">${formatPrice(coin.price)}</td>
                    <td class="py-2 text-red-400">${coin.change24h.toFixed(2)}%</td>
                </tr>
            `).join('');
        }

        function initDashboardCharts() {
            // ‰ª∑Ê†ºËµ∞ÂäøÊ®°ÊãüÂõæ
            const priceCtx = document.getElementById('priceChart');
            if (priceCtx && !charts.price) {
                charts.price = new Chart(priceCtx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                        datasets: [
                            {
                                label: 'BTC',
                                data: generateRandomData(24, 70000, 72000),
                                borderColor: '#f59e0b',
                                backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                fill: true,
                                tension: 0.4
                            },
                            {
                                label: 'ETH',
                                data: generateRandomData(24, 2000, 2200),
                                borderColor: '#8b5cf6',
                                backgroundColor: 'rgba(139, 92, 246, 0.1)',
                                fill: true,
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { labels: { color: '#9ca3af' } } },
                        scales: {
                            x: { ticks: { color: '#6b7280' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                            y: { ticks: { color: '#6b7280' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                        }
                    }
                });
            }
            
            // Â∏ÇÂÄºÈ•ºÂõæ
            const marketCtx = document.getElementById('marketChart');
            if (marketCtx && !charts.market) {
                charts.market = new Chart(marketCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['BTC', 'ETH', 'SOL', 'BNB', 'ÂÖ∂‰ªñ'],
                        datasets: [{
                            data: [45, 25, 10, 8, 12],
                            backgroundColor: ['#f59e0b', '#8b5cf6', '#22c55e', '#ef4444', '#6b7280']
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { position: 'right', labels: { color: '#9ca3af' } } }
                    }
                });
            }
        }

        // ============== ÊäïËµÑÁªÑÂêà ==============
        function renderPortfolio() {
            if (!portfolio || !portfolio.holdings) return;
            
            // Êõ¥Êñ∞Ê±áÊÄª
            document.getElementById('pf-total-value').textContent = formatPrice(portfolio.totalValue);
            document.getElementById('pf-total-cost').textContent = formatPrice(portfolio.totalCost);
            const profit = portfolio.totalProfitPercent || 0;
            document.getElementById('pf-total-profit').textContent = `${profit >= 0 ? '+' : ''}${profit.toFixed(2)}%`;
            document.getElementById('pf-total-profit').className = profit >= 0 ? 'text-xl font-bold text-green-400' : 'text-xl font-bold text-red-400';
            
            // Ê∏≤ÊüìÊåÅ‰ªì
            const tbody = document.getElementById('holdings-table');
            if (portfolio.holdings.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="py-8 text-center text-gray-400">ÊöÇÊó†ÊåÅ‰ªìÔºåÁÇπÂáªÂè≥‰∏äËßíÊ∑ªÂä†</td></tr>';
                return;
            }
            
            tbody.innerHTML = portfolio.holdings.map((h, i) => `
                <tr class="border-b border-white/5 hover:bg-white/5">
                    <td class="py-3 font-medium">${h.symbol}</td>
                    <td class="py-3">${h.amount.toFixed(4)}</td>
                    <td class="py-3">${formatPrice(h.avgPrice)}</td>
                    <td class="py-3">${formatPrice(h.currentPrice)}</td>
                    <td class="py-3 text-green-400">${formatPrice(h.value)}</td>
                    <td class="py-3 ${h.profit >= 0 ? 'text-green-400' : 'text-red-400'}">
                        ${h.profit >= 0 ? '+' : ''}${h.profitPercent.toFixed(2)}%
                    </td>
                    <td class="py-3">
                        <button onclick="sellHolding('${h.symbol}', ${h.amount})" class="text-xs bg-red-500/20 text-red-400 px-2 py-1 rounded hover:bg-red-500/30">
                            ÂçñÂá∫
                        </button>
                    </td>
                </tr>
            `).join('');
            
            // Ê∏≤Êüì‰∫§ÊòìÂéÜÂè≤
            const historyContainer = document.getElementById('pf-history');
            if (portfolio.transactions && portfolio.transactions.length > 0) {
                historyContainer.innerHTML = portfolio.transactions.slice(0, 20).reverse().map(t => `
                    <div class="flex items-center justify-between p-2 bg-white/5 rounded-lg">
                        <div class="flex items-center gap-2">
                            <span class="${t.type === 'BUY' ? 'text-green-400' : 'text-red-400'}">${t.type === 'BUY' ? 'üü¢' : 'üî¥'}</span>
                            <span class="font-medium">${t.symbol}</span>
                            <span class="text-xs text-gray-400">${t.type}</span>
                        </div>
                        <div class="text-right text-xs">
                            <p>${formatPrice(t.total)}</p>
                            <p class="text-gray-400">${new Date(t.timestamp).toLocaleDateString()}</p>
                        </div>
                    </div>
                `).join('');
            }
        }

        function openModal(modalName) {
            document.getElementById(`modal-${modalName}`).classList.remove('hidden');
        }
        
        function closeModal(modalName) {
            document.getElementById(`modal-${modalName}`).classList.add('hidden');
        }
        
        function addHolding() {
            const symbol = document.getElementById('holding-symbol').value.toUpperCase();
            const amount = parseFloat(document.getElementById('holding-amount').value);
            const price = parseFloat(document.getElementById('holding-price').value);
            const exchange = document.getElementById('holding-exchange').value;
            
            if (!symbol || !amount || !price) {
                alert('ËØ∑Â°´ÂÜôÂÆåÊï¥‰ø°ÊÅØ');
                return;
            }
            
            // ‰øùÂ≠òÂà∞Êú¨Âú∞Â≠òÂÇ®
            const holdings = JSON.parse(localStorage.getItem('crypto_holdings') || '[]');
            const existing = holdings.find(h => h.symbol === symbol);
            if (existing) {
                const totalCost = existing.amount * existing.avgPrice + amount * price;
                existing.amount += amount;
                existing.avgPrice = totalCost / existing.amount;
            } else {
                holdings.push({ symbol, amount, avgPrice: price, exchange, currentPrice: price });
            }
            localStorage.setItem('crypto_holdings', JSON.stringify(holdings));
            
            closeModal('addHolding');
            loadPortfolioFromStorage();
            showNotification('‚úÖ ÊåÅ‰ªìÊ∑ªÂä†ÊàêÂäü');
        }
        
        function loadPortfolioFromStorage() {
            const holdings = JSON.parse(localStorage.getItem('crypto_holdings') || '[]');
            let totalValue = 0, totalCost = 0;
            
            const enrichedHoldings = holdings.map(h => {
                const price = prices[h.symbol]?.price || h.currentPrice;
                const value = h.amount * price;
                const cost = h.amount * h.avgPrice;
                totalValue += value;
                totalCost += cost;
                return { ...h, currentPrice: price, value, profit: value - cost, profitPercent: cost > 0 ? ((value - cost) / cost) * 100 : 0 };
            });
            
            portfolio = {
                holdings: enrichedHoldings,
                totalValue,
                totalCost,
                totalProfit: totalValue - totalCost,
                totalProfitPercent: totalCost > 0 ? ((totalValue - totalCost) / totalCost) * 100 : 0,
                transactions: []
            };
            
            renderPortfolio();
        }

        // ============== Ê®°Êãü‰∫§Êòì ==============
        function renderPaperTrading() {
            if (!paperTrading) {
                paperTrading = { balance: 10000, stats: { totalProfit: 0, totalTrades: 0, winRate: 0 }, positions: [], trades: [] };
            }
            
            document.getElementById('pt-balance').textContent = formatPrice(paperTrading.balance);
            document.getElementById('pt-profit').textContent = `${paperTrading.stats.totalProfit >= 0 ? '+' : ''}${formatPrice(paperTrading.stats.totalProfit)}`;
            document.getElementById('pt-profit').className = paperTrading.stats.totalProfit >= 0 ? 'text-xl font-bold text-green-400' : 'text-xl font-bold text-red-400';
            document.getElementById('pt-trades').textContent = paperTrading.stats.totalTrades || 0;
            document.getElementById('pt-winrate').textContent = `${(paperTrading.stats.winRate || 0).toFixed(1)}%`;
            
            // Ê∏≤ÊüìÊåÅ‰ªì
            const positionsContainer = document.getElementById('pt-positions');
            if (paperTrading.positions && paperTrading.positions.length > 0) {
                positionsContainer.innerHTML = paperTrading.positions.map(p => `
                    <div class="flex items-center justify-between p-3 bg-white/5 rounded-lg border border-purple-500/30">
                        <div>
                            <p class="font-medium">${p.symbol}</p>
                            <p class="text-xs text-gray-400">Êï∞Èáè: ${p.amount.toFixed(4)} | Âùá‰ª∑: ${formatPrice(p.avgPrice)}</p>
                        </div>
                        <button onclick="closePosition('${p.symbol}')" class="text-xs bg-red-500/20 text-red-400 px-3 py-1 rounded">Âπ≥‰ªì</button>
                    </div>
                `).join('');
            } else {
                positionsContainer.innerHTML = '<p class="text-gray-400 text-center py-4">ÊöÇÊó†ÊåÅ‰ªìÔºåÂºÄÂßã‰∫§ÊòìÂêßÔºÅ</p>';
            }
            
            // Ê∏≤Êüì‰∫§ÊòìÂéÜÂè≤
            const historyContainer = document.getElementById('pt-history');
            if (paperTrading.trades && paperTrading.trades.length > 0) {
                historyContainer.innerHTML = paperTrading.trades.slice().reverse().slice(0, 30).map(t => `
                    <div class="flex items-center justify-between p-2 bg-white/5 rounded-lg">
                        <div class="flex items-center gap-2">
                            <span class="${t.type === 'BUY' ? 'text-green-400' : 'text-red-400'}">${t.type === 'BUY' ? 'üü¢' : 'üî¥'}</span>
                            <span class="font-medium">${t.symbol}</span>
                            <span class="text-xs ${t.type === 'BUY' ? 'text-green-400' : 'text-red-400'}">${t.type}</span>
                        </div>
                        <div class="text-right text-xs">
                            <p>${t.amount.toFixed(4)} @ ${formatPrice(t.price)}</p>
                            <p class="text-gray-400">${formatPrice(t.total)}</p>
                        </div>
                    </div>
                `).join('');
            }
        }
        
        function executeTrade(action) {
            const symbol = document.getElementById('trade-symbol').value;
            const amount = parseFloat(document.getElementById('trade-amount').value);
            let price = parseFloat(document.getElementById('trade-price').value);
            
            if (!amount || amount <= 0) {
                showNotification('ËØ∑ËæìÂÖ•ÊúâÊïàÊï∞Èáè', 'warning');
                return;
            }
            
            // ‰ΩøÁî®ÂΩìÂâçÂ∏ÇÂú∫‰ª∑Ê†º
            if (!price || document.getElementById('trade-type').value === 'market') {
                price = prices[symbol]?.price || generateMockPrice(symbol);
            }
            
            const total = amount * price;
            
            if (action === 'buy') {
                if (total > (paperTrading?.balance || 10000)) {
                    showNotification('‰ΩôÈ¢ù‰∏çË∂≥', 'error');
                    return;
                }
                if (!paperTrading.positions) paperTrading.positions = [];
                if (!paperTrading.trades) paperTrading.trades = [];
                
                const existing = paperTrading.positions.find(p => p.symbol === symbol);
                if (existing) {
                    existing.amount += amount;
                    existing.avgPrice = (existing.amount * existing.avgPrice + total) / existing.amount;
                } else {
                    paperTrading.positions.push({ symbol, amount, avgPrice: price });
                }
                paperTrading.balance -= total;
                paperTrading.trades.push({ type: 'BUY', symbol, amount, price, total, timestamp: new Date() });
            } else {
                const position = paperTrading.positions?.find(p => p.symbol === symbol);
                if (!position || position.amount < amount) {
                    showNotification('ÊåÅ‰ªì‰∏çË∂≥', 'error');
                    return;
                }
                position.amount -= amount;
                if (position.amount <= 0) {
                    paperTrading.positions = paperTrading.positions.filter(p => p.symbol !== symbol);
                }
                paperTrading.balance += total;
                paperTrading.trades.push({ type: 'SELL', symbol, amount, price, total, timestamp: new Date() });
            }
            
            // Êõ¥Êñ∞ÁªüËÆ°
            if (!paperTrading.stats) paperTrading.stats = { totalTrades: 0, winningTrades: 0, totalProfit: 0, winRate: 0 };
            paperTrading.stats.totalTrades = paperTrading.trades.length;
            paperTrading.stats.totalProfit = paperTrading.balance - 10000;
            
            renderPaperTrading();
            showNotification(`${action === 'buy' ? 'üü¢ ‰π∞ÂÖ•' : 'üî¥ ÂçñÂá∫'} ${symbol} ${amount} @ ${formatPrice(price)}`);
            
            // ‰øùÂ≠òÂà∞Êú¨Âú∞
            localStorage.setItem('crypto_paper_trading', JSON.stringify(paperTrading));
        }
        
        function resetPaperTrading() {
            if (confirm('Á°ÆÂÆöÈáçÁΩÆÊ®°Êãü‰∫§ÊòìË¥¶Êà∑ÔºüÊâÄÊúâÊï∞ÊçÆÂ∞ÜË¢´Ê∏ÖÈô§„ÄÇ')) {
                paperTrading = { balance: 10000, positions: [], trades: [], stats: { totalTrades: 0, winningTrades: 0, totalProfit: 0, winRate: 0 } };
                localStorage.removeItem('crypto_paper_trading');
                renderPaperTrading();
                showNotification('üîÑ Ê®°Êãü‰∫§ÊòìÂ∑≤ÈáçÁΩÆ');
            }
        }
        
        function loadPaperTradingFromStorage() {
            const saved = localStorage.getItem('crypto_paper_trading');
            if (saved) {
                paperTrading = JSON.parse(saved);
            } else {
                paperTrading = { balance: 10000, positions: [], trades: [], stats: { totalTrades: 0, winningTrades: 0, totalProfit: 0, winRate: 0 } };
            }
            renderPaperTrading();
        }
        
        function generateMockPrice(symbol) {
            const mock = { 'BTC': 71130, 'ETH': 2110, 'SOL': 87.73, 'BNB': 643.45 };
            return mock[symbol] || 100;
        }

        // ============== Êô∫ËÉΩÊèêÈÜí ==============
        function renderAlerts() {
            if (!alerts) alerts = { priceAlerts: [], supportResistance: [] };
            
            // ‰ª∑Ê†ºÊèêÈÜí
            const priceList = document.getElementById('price-alerts-list');
            if (alerts.priceAlerts && alerts.priceAlerts.length > 0) {
                priceList.innerHTML = alerts.priceAlerts.map((a, i) => `
                    <div class="flex items-center gap-2 px-3 py-2 bg-white/5 rounded-lg border ${a.triggered ? 'border-green-500' : 'border-purple-500'}">
                        <span>${a.direction === 'above' ? 'üöÄ' : 'üìâ'}</span>
                        <span class="font-medium">${a.symbol}</span>
                        <span class="text-sm text-gray-400">$</span>
                        <span class="text-sm">${a.targetPrice}</span>
                        <span class="text-xs ${a.triggered ? 'text-green-400' : 'text-gray-500'}">${a.triggered ? '‚úì' : ''}</span>
                        <button onclick="deleteAlert('price', ${i})" class="text-red-400 ml-1">√ó</button>
                    </div>
                `).join('');
            } else {
                priceList.innerHTML = '<p class="text-gray-400 text-sm">ÊöÇÊó†‰ª∑Ê†ºÊèêÈÜí</p>';
            }
            
            // ÊîØÊíë/ÈòªÂäõ‰Ωç
            const srList = document.getElementById('sr-alerts-list');
            if (alerts.supportResistance && alerts.supportResistance.length > 0) {
                srList.innerHTML = alerts.supportResistance.map((a, i) => `
                    <div class="flex items-center gap-2 px-3 py-2 bg-white/5 rounded-lg border border-yellow-500/50">
                        <span>${a.type === 'support' ? 'üü¢' : a.type === 'resistance' ? 'üî¥' : 'üìä'}</span>
                        <span class="font-medium">${a.symbol}</span>
                        <span class="text-xs text-gray-400">${a.levels.join(', ')}</span>
                        <button onclick="deleteAlert('sr', ${i})" class="text-red-400 ml-1">√ó</button>
                    </div>
                `).join('');
            } else {
                srList.innerHTML = '<p class="text-gray-400 text-sm">ÊöÇÊó†ÊîØÊíë/ÈòªÂäõ‰ΩçËÆæÁΩÆ</p>';
            }
            
            // Ê¥ªË∑ÉÊèêÈÜíÊï∞
            document.getElementById('active-alerts').textContent = (alerts.priceAlerts?.length || 0) + (alerts.supportResistance?.length || 0);
        }
        
        function addPriceAlert() {
            const symbol = document.getElementById('alert-symbol').value.toUpperCase();
            const price = parseFloat(document.getElementById('alert-price').value);
            const direction = document.getElementById('alert-direction').value;
            
            if (!symbol || !price) {
                showNotification('ËØ∑Â°´ÂÜôÂÆåÊï¥‰ø°ÊÅØ', 'warning');
                return;
            }
            
            if (!alerts.priceAlerts) alerts.priceAlerts = [];
            alerts.priceAlerts.push({
                id: Date.now(),
                symbol,
                targetPrice: price,
                direction,
                triggered: false
            });
            
            saveAlertsToStorage();
            renderAlerts();
            showNotification(`‚úÖ Â∑≤Ê∑ªÂä† ${symbol} ‰ª∑Ê†ºÊèêÈÜí`);
            
            document.getElementById('alert-symbol').value = '';
            document.getElementById('alert-price').value = '';
        }
        
        function addSRAlert() {
            const symbol = document.getElementById('sr-symbol').value.toUpperCase();
            const level = parseFloat(document.getElementById('sr-level').value);
            const type = document.getElementById('sr-type').value;
            
            if (!symbol || !level) {
                showNotification('ËØ∑Â°´ÂÜôÂÆåÊï¥‰ø°ÊÅØ', 'warning');
                return;
            }
            
            if (!alerts.supportResistance) alerts.supportResistance = [];
            alerts.supportResistance.push({
                id: Date.now(),
                symbol,
                levels: [level],
                type
            });
            
            saveAlertsToStorage();
            renderAlerts();
            showNotification(`‚úÖ Â∑≤Ê∑ªÂä† ${symbol} ÊîØÊíë/ÈòªÂäõ‰ΩçÊèêÈÜí`);
        }
        
        function addMultiSR() {
            const symbol = document.getElementById('sr-multi-symbol').value.toUpperCase();
            const levelsStr = document.getElementById('sr-multi-levels').value;
            const levels = levelsStr.split(',').map(l => parseFloat(l.trim())).filter(l => !isNaN(l));
            
            if (!symbol || levels.length === 0) {
                showNotification('ËØ∑Â°´ÂÜôÂ∏ÅÁßçÂíå‰ª∑Ê†º‰Ωç', 'warning');
                return;
            }
            
            if (!alerts.supportResistance) alerts.supportResistance = [];
            alerts.supportResistance.push({
                id: Date.now(),
                symbol,
                levels,
                type: 'both'
            });
            
            saveAlertsToStorage();
            renderAlerts();
            showNotification(`‚úÖ Â∑≤Ê∑ªÂä† ${symbol} ÊâπÈáèÊîØÊíë/ÈòªÂäõ‰Ωç`);
        }
        
        function deleteAlert(type, index) {
            if (type === 'price') {
                alerts.priceAlerts.splice(index, 1);
            } else {
                alerts.supportResistance.splice(index, 1);
            }
            saveAlertsToStorage();
            renderAlerts();
        }
        
        function resetAlerts() {
            if (alerts.priceAlerts) {
                alerts.priceAlerts.forEach(a => a.triggered = false);
            }
            saveAlertsToStorage();
            renderAlerts();
            showNotification('‚úÖ Â∑≤ÈáçÁΩÆÊèêÈÜíÁä∂ÊÄÅ');
        }
        
        function checkAlerts() {
            if (!alerts || !alerts.priceAlerts) return;
            
            alerts.priceAlerts.forEach(alert => {
                if (alert.triggered) return;
                
                const currentPrice = prices[alert.symbol]?.price;
                if (!currentPrice) return;
                
                if (alert.direction === 'above' && currentPrice >= alert.targetPrice) {
                    alert.triggered = true;
                    showNotification(`üö® ${alert.symbol} ‰ª∑Ê†ºÁ™ÅÁ†¥ $${alert.targetPrice}! ÂΩìÂâç: ${formatPrice(currentPrice)}`, 'error');
                } else if (alert.direction === 'below' && currentPrice <= alert.targetPrice) {
                    alert.triggered = true;
                    showNotification(`üö® ${alert.symbol} ‰ª∑Ê†ºË∑åÁ†¥ $${alert.targetPrice}! ÂΩìÂâç: ${formatPrice(currentPrice)}`, 'error');
                }
            });
            
            saveAlertsToStorage();
            renderAlerts();
        }
        
        function saveAlertsToStorage() {
            localStorage.setItem('crypto_alerts', JSON.stringify(alerts));
        }
        
        function loadAlertsFromStorage() {
            const saved = localStorage.getItem('crypto_alerts');
            if (saved) {
                alerts = JSON.parse(saved);
            } else {
                alerts = { priceAlerts: [], supportResistance: [] };
            }
            renderAlerts();
        }

        // ============== Ë∂ãÂäøÂàÜÊûê ==============
        function initAnalysisChart() {
            const ctx = document.getElementById('trendChart');
            if (!ctx) return;
            
            if (charts.trend) charts.trend.destroy();
            
            const symbol = document.getElementById('chart-symbol').value;
            const period = document.getElementById('chart-period').value;
            
            const dataPoints = period === '24h' ? 24 : period === '7d' ? 7 * 24 : 30;
            const basePrice = prices[symbol]?.price || generateMockPrice(symbol);
            
            const data = [];
            const labels = [];
            for (let i = dataPoints; i >= 0; i--) {
                data.push(basePrice * (1 + (Math.random() - 0.5) * 0.1));
                if (period === '24h') {
                    labels.push(`${i}:00`);
                } else {
                    labels.push(`D-${i}`);
                }
            }
            
            charts.trend = new Chart(ctx, {
                type: 'line',
                data: {
                    labels,
                    datasets: [{
                        label: `${symbol}/USDT`,
                        data,
                        borderColor: '#8b5cf6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { labels: { color: '#9ca3af' } },
                        title: { display: true, text: `${symbol} ‰ª∑Ê†ºË∂ãÂäø`, color: '#fff' }
                    },
                    scales: {
                        x: { ticks: { color: '#6b7280' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        y: { ticks: { color: '#6b7280' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                    }
                }
            });
            
            // Êõ¥Êñ∞ÊäÄÊúØÊåáÊ†á
            updateTechnicalIndicators(basePrice);
            
            // Êõ¥Êñ∞ÊîØÊíë/ÈòªÂäõ‰Ωç
            const supportLevels = [basePrice * 0.95, basePrice * 0.9, basePrice * 0.85];
            const resistanceLevels = [basePrice * 1.05, basePrice * 1.1, basePrice * 1.15];
            
            document.getElementById('support-levels').textContent = supportLevels.map(p => formatPrice(p)).join(', ');
            document.getElementById('resistance-levels').textContent = resistanceLevels.map(p => formatPrice(p)).join(', ');
        }
        
        function updateTechnicalIndicators(price) {
            // RSI
            const rsi = 50 + (Math.random() - 0.5) * 60;
            document.getElementById('rsi-value').textContent = rsi.toFixed(1);
            document.getElementById('rsi-bar').style.width = `${rsi}%`;
            document.getElementById('rsi-bar').className = `h-full transition-all ${rsi > 70 ? 'bg-red-500' : rsi < 30 ? 'bg-green-500' : 'bg-blue-500'}`;
            document.getElementById('rsi-signal').textContent = rsi > 70 ? '‚ö†Ô∏è Ë∂Ö‰π∞' : rsi < 30 ? '‚ö†Ô∏è Ë∂ÖÂçñ' : 'üìä ‰∏≠ÊÄß';
            
            // MACD
            const macd = (Math.random() - 0.5) * 100;
            const signal = (Math.random() - 0.5) * 100;
            const hist = macd - signal;
            
            document.getElementById('macd-value').textContent = macd.toFixed(2);
            document.getElementById('macd-signal').textContent = signal.toFixed(2);
            document.getElementById('macd-hist').textContent = hist.toFixed(2);
            document.getElementById('macd-hist').className = `font-semibold ${hist >= 0 ? 'text-green-400' : 'text-red-400'}`;
            document.getElementById('macd-trend').textContent = hist >= 0 ? 'üìà ‰∏äÊ∂®Ë∂ãÂäø' : 'üìâ ‰∏ãË∑åË∂ãÂäø';
            
            // MA
            document.getElementById('ma7').textContent = formatPrice(price * (1 + Math.random() * 0.02));
            document.getElementById('ma25').textContent = formatPrice(price * (1 + Math.random() * 0.03));
            document.getElementById('ma99').textContent = formatPrice(price * (1 + Math.random() * 0.05));
            
            // ÁªºÂêà‰ø°Âè∑
            const signals = [];
            if (rsi > 70) signals.push('üî¥');
            else if (rsi < 30) signals.push('üü¢');
            
            if (hist > 0) signals.push('üìà');
            else signals.push('üìâ');
            
            const avgMA7 = price * 1.01, avgMA25 = price * 0.99;
            if (price > avgMA7) signals.push('üü¢');
            else if (price < avgMA7) signals.push('üî¥');
            
            const buySignals = signals.filter(s => s === 'üü¢' || s === 'üìà').length;
            const sellSignals = signals.filter(s => s === 'üî¥' || s === 'üìâ').length;
            
            document.getElementById('overall-signal').textContent = buySignals > sellSignals ? 'üü¢' : sellSignals > buySignals ? 'üî¥' : '‚ö™';
            document.getElementById('signal-text').textContent = buySignals > sellSignals ? '‰π∞ÂÖ•‰ø°Âè∑' : sellSignals > buySignals ? 'ÂçñÂá∫‰ø°Âè∑' : 'ËßÇÊúõ';
        }

        // ============== ‰∫§ÊòìÊâÄÂØπÊØî ==============
        function updateExchangeComparison() {
            const tbody = document.getElementById('exchange-comparison');
            const coins = ['BTC', 'ETH', 'SOL', 'BNB', 'XRP'];
            
            tbody.innerHTML = coins.map(symbol => {
                const coin = prices[symbol] || { price: generateMockPrice(symbol), change24h: 0 };
                const binancePrice = coin.price * (1 + (Math.random() - 0.5) * 0.002);
                const coingeckoPrice = coin.price * (1 + (Math.random() - 0.5) * 0.002);
                const avgPrice = (binancePrice + coingeckoPrice) / 2;
                const spread = Math.abs(binancePrice - coingeckoPrice);
                const spreadPercent = (spread / avgPrice * 100).toFixed(3);
                
                return `
                    <tr class="border-b border-white/5 hover:bg-white/5">
                        <td class="py-3 font-medium">${symbol}</td>
                        <td class="py-3 text-green-400">${formatPrice(binancePrice)}</td>
                        <td class="py-3 text-blue-400">${formatPrice(coingeckoPrice)}</td>
                        <td class="py-3">${formatPrice(avgPrice)}</td>
                        <td class="py-3 ${spreadPercent < 0.1 ? 'text-green-400' : 'text-yellow-400'}">${spreadPercent}%</td>
                        <td class="py-3 ${coin.change24h >= 0 ? 'text-green-400' : 'text-red-400'}">
                            ${coin.change24h >= 0 ? '+' : ''}${coin.change24h.toFixed(2)}%
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // ============== Â∑•ÂÖ∑ÂáΩÊï∞ ==============
        function formatPrice(price) {
            if (!price) return '$0.00';
            if (price >= 1) {
                return '$' + price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            } else if (price >= 0.001) {
                return '$' + price.toFixed(4);
            } else {
                return '$' + price.toFixed(8);
            }
        }
        
        function generateRandomData(count, min, max) {
            const data = [];
            let current = (min + max) / 2;
            for (let i = 0; i < count; i++) {
                current += (Math.random() - 0.5) * (max - min) * 0.2;
                current = Math.max(min, Math.min(max, current));
                data.push(current);
            }
            return data;
        }
        
        function showNotification(message, type = 'info') {
            const container = document.createElement('div');
            const bgColor = type === 'error' ? 'bg-red-600' : type === 'warning' ? 'bg-yellow-600' : 'bg-purple-600';
            container.className = `fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 text-white ${bgColor} animate-pulse`;
            container.textContent = message;
            document.body.appendChild(container);
            setTimeout(() => container.remove(), 3000);
        }

        // ============== È°µÈù¢ÂàùÂßãÂåñ ==============
        async function init() {
            try {
                await refreshAllData();
            } catch (e) {
                console.warn('API‰∏çÂèØÁî®Ôºå‰ΩøÁî®Êú¨Âú∞Êï∞ÊçÆ');
                useMockData();
            }
            loadPortfolioFromStorage();
            loadPaperTradingFromStorage();
            loadAlertsFromStorage();
        }
        
        init();
    </script>
</body>
</html>
